<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Budget & Forecast — ING-stijl (zonder logo's)</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="icon" href="data:,">
  <meta name="description" content="Simpel tooltje om inkomsten/uitgaven te beheren, labels toe te voegen en forecasts te maken per week/maand/kwartaal/jaar.">
  <script defer src="app.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header class="app-header">
    <h1>Budget & Forecast</h1>
    <div class="header-actions">
      <button id="addExpenseBtn" class="btn">Nieuwe uitgave</button>
      <button id="addIncomeBtn" class="btn primary">Nieuwe inkomst</button>
      <button id="exportBtn" class="btn">Exporteren</button>
      <label class="file-import btn">
        <input id="importFile" type="file" accept="application/json" hidden />
        Importeren
      </label>
    </div>
  </header>
  <div id="debugBanner" class="hidden" style="display:none"></div>
  <div id="debugTools" style="display:none; padding:8px 16px;">
    <button id="debugBtn" class="btn" style="border-style:dashed">Test popup openen</button>
  </div>


  <main class="container">
    <section class="filters">
      <div class="range-controls">
        <label for="rangeSelect">Periode:</label>
        <select id="rangeSelect">
          <option value="week">Week</option>
          <option value="maand" selected>Maand</option>
          <option value="kwartaal">Kwartaal</option>
          <option value="jaar">Jaar</option>
          <option value="custom">Aangepast…</option>
        </select>

        <div id="customRange" class="custom-range hidden">
          <label>van <input type="date" id="fromDate"></label>
          <label>tot en met <input type="date" id="toDate"></label>
        </div>

        <button id="prevRange" class="btn ghost" aria-label="Vorige periode">←</button>
        <button id="nextRange" class="btn ghost" aria-label="Volgende periode">→</button>
        <button id="todayRange" class="btn ghost">Naar vandaag</button>
      </div>

      <div class="tag-filter">
        <label for="labelFilter">Label:</label>
        <select id="labelFilter">
          <option value="">Alle labels</option>
        </select>
      </div>
    </section>

    <section class="kpis">
      <div class="card kpi">
        <div class="kpi-label">Huidig saldo</div>
        <div class="kpi-value" id="kpiSaldo">€ 0,00</div>
      </div>
      <div class="card kpi">
        <div class="kpi-label">Inkomsten (periode)</div>
        <div class="kpi-value positive" id="kpiIncome">€ 0,00</div>
      </div>
      <div class="card kpi">
        <div class="kpi-label">Uitgaven (periode)</div>
        <div class="kpi-value negative" id="kpiExpense">€ 0,00</div>
      </div>
      <div class="card kpi">
        <div class="kpi-label">Netto (periode)</div>
        <div class="kpi-value" id="kpiNetto">€ 0,00</div>
      </div>
      <div class="card kpi">
        <div class="kpi-label">Forecast (periode)</div>
        <div class="kpi-value" id="kpiForecast">€ 0,00</div>
        <div class="kpi-subtext">Gebaseerd op terugkerende posten</div>
      </div>
    </section>

    <section class="grid">
      <div class="card">
        <h2>Verdeling per label</h2>
        <canvas id="labelChart" height="200"></canvas>
      </div>
      <div class="card">
        <h2>Saldo over tijd</h2>
        <canvas id="saldoChart" height="200"></canvas>
      </div>
    </section>

    <section class="whatif card">
      <div class="whatif-header">
        <h2>What‑if: kan deze aankoop?</h2>
        <span class="muted">Voeg een hypothetische uitgave toe en zie de impact op je forecast.</span>
      </div>
      <div class="whatif-form">
        <label>Datum <input type="date" id="whatIfDate"></label>
        <label>Bedrag (€) <input type="number" step="0.01" id="whatIfAmount" placeholder="0,00"></label>
        <button id="whatIfBtn" class="btn">Doorrekenen</button>
      </div>
      <div class="whatif-result">
        <div>Nieuwe forecast: <strong id="whatIfForecast">€ 0,00</strong></div>
        <div class="muted">Verschil: <span id="whatIfDelta">€ 0,00</span></div>
      </div>
    </section>

    <section class="transactions card">
      <div class="transactions-head">
        <h2>Transacties</h2>
        <div class="search">
          <input type="search" id="searchInput" placeholder="Zoeken in omschrijving/label…" />
        </div>
      </div>
      <div class="table-wrap">
        <table id="txnTable">
          <thead>
            <tr>
              <th data-sort="date">Datum</th>
              <th data-sort="type">Type</th>
              <th data-sort="amount">Bedrag</th>
              <th data-sort="label">Label</th>
              <th>Beschrijving</th>
              <th>Terugkerend</th>
              <th></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>
  </main>

  <!-- Modal: nieuwe/bewerken transactie -->
  <div id="modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal-content" role="document">
      <div class="modal-header">
        <h3 id="modalTitle">Nieuwe transactie</h3>
        <button id="modalClose" class="icon-btn" aria-label="Sluiten">✕</button>
      </div>
      <form id="txnForm" class="modal-body">
        <input type="hidden" id="txnId" />
        <div class="form-grid">
          <label>Type
            <select id="txnType" required>
              <option value="income">Inkomst</option>
              <option value="expense" selected>Uitgave</option>
            </select>
          </label>
          <label>Bedrag (€)
            <input id="txnAmount" type="number" step="0.01" min="0" placeholder="0,00" required />
          </label>
          <label>Datum
            <input id="txnDate" type="date" required />
          </label>
          <label>Label
            <input id="txnLabel" list="labelList" placeholder="bijv. boodschappen" />
            <datalist id="labelList"></datalist>
          </label>
          <label>Beschrijving
            <input id="txnNotes" type="text" placeholder="optioneel" />
          </label>
        </div>

        <fieldset class="recurring">
          <legend>Terugkerend</legend>
          <label class="inline">
            <input id="txnRecurring" type="checkbox" />
            Deze transactie keert terug
          </label>
          <div class="recurring-row">
            <label>Frequentie
              <select id="txnFrequency">
                <option value="weekly">Wekelijks</option>
                <option value="monthly" selected>Maandelijks</option>
                <option value="yearly">Jaarlijks</option>
              </select>
            </label>
            <label>Einddatum (optioneel)
              <input id="txnUntil" type="date" />
            </label>
          </div>
        </fieldset>

        <div class="modal-actions">
          <button type="submit" class="btn primary">Opslaan</button>
          <button type="button" id="deleteBtn" class="btn danger hidden">Verwijderen</button>
        </div>
      </form>
    </div>
  </div>

  <footer class="app-footer">
    <div>Gemaakt in ING‑stijl (zonder logo's). Data wordt lokaal opgeslagen in je browser.</div>
    <a href="README.md">Handleiding</a>
  </footer>
</body>
</html>
